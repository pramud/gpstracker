
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" type="text/css" href="jquery/css/jquery.mobile-1.4.2.css" />
  <link rel="stylesheet" type="text/css" href="jquery/css/jquery.mobile.flatui.css" />
 <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.6.4/leaflet.css" />
  <script src="http://cdn.leafletjs.com/leaflet-0.6.4/leaflet.js"></script>
  <script src="jquery.js"></script>
  <script src="jquery.mobile-1.4.0-rc.1.js"></script>
  <script src="pouchdb-2.1.0.min.js"></script>
  
  
  <script>
  function onMap()
  {
     map = L.map('map').setView([17, 78], 13);
     L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
    attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="http://cloudmade.com">CloudMade</a>',
    maxZoom: 18
}).addTo(map);
     db.allDocs({include_docs: true}, function(err, response) {
      if (err) {
      callback(err);
      return;
                }
      console.log(response.rows);
      var str =" ";
      for( var i=0;i<response.rows.length;i++){
        str2= response.rows[i].doc.latitude; str3= response.rows[i].doc.longitude  ;
        var marker = L.marker([str2, str3]).addTo(map);
       
      
       
      }
        document.getElementById("omap").innerHTML = map;
                 });
  
   
     }
  </script>
  
  
  
  
  
  
  <script>
  
   var str1;var str2; var str3;
  function previous()
  {
      db.allDocs({include_docs: true}, function(err, response) {
      if (err) {
      callback(err);
      return;
                }
      console.log(response.rows);
      var str =" ";
      for( var i=0;i<response.rows.length;i++){
        str1 = response.rows[i].doc._id;str2= response.rows[i].doc.latitude; str3= response.rows[i].doc.longitude  ;
        str =str+ ""+ str1 + " "+ str2 + " " +str3+"<br></br>" ;
       
      
       
      }
       document.getElementById("onmap").innerHTML =str ; 
                 });
  
  
  }
  </script>
  
  
  
  
  
  
  
  
  
  
  
  <script>
  var db = new PouchDB('GPSdata');
 
 
  
  
  
  
function save(){

  
  
  
  alert("GPSdata vatiable created");
  if(date==null || lat==null || long== null) alert("all or some your variables: NULL");
  else{
  var data = {_id:date,latitude:lat,longitude:long};
    alert("data copied to array");
    db.post(data, function callback(err, result) {
    if (err) {
      console.log(err);
      return;
      
           }
    else if(result && result.ok){alert("Data written to database succesfully");
        alert("Result " +result.rows);
    
        
    }
  });
    

    
    
    }
  }
  </script>
   
<script>
 
  function xyz(){

   var cdb = new PouchDB('cdb1'),
    remote = 'https://phonegap.couchappy.com/workingdatabase',
    opts = {
        continuous: true
    };

cdb.post({
  "location": 'Johannesburg',
  "userid": nom
});


cdb.replicate.to(remote, opts); 
  alert("Done replicatin lithelikeplyingstintspec:NwlceV4vITT2TXsoVLLGlyGB");
  }
  </script>




  <script>
  function addin(){


   var newdb = new PouchDB('newdb1'),
    remote = 'https://phonegap.couchappy.com/workingdatabase',
    opts = {
        continuous: true
    };

newdb.post({
    "location": 'NewJersey',
    "userid": nom 
});


newdb.replicate.to(remote, opts); 
 
  alert("Done replicatin anotha");
  }
  </script>
  


  <script>
  function dispfaf(){
   var dispdb = new PouchDB('what'),
    remote = 'https://phonegap.couchappy.com/whatdahell',
    opts = {
        continuous: true
    };
dispdb.replicate.from(remote, opts); 
  alert("Done replicatin anotha");

//Show elements
   var a,b;

 dispdb.allDocs({include_docs: true}, function(err, response) {
      if (err) {
      callback(err);
      return;
                }
      console.log(response.rows);
      var x =" ";
      for( var i=0;i<response.rows.length;i++){
        a = response.rows[i].doc._id;b= response.rows[i].doc.name; 
        x =x+ ""+ a + " "+ b + " " +"\n\n" ;
       
      }
       alert(x);
                 });
 

  }
  </script>
  
<script>
function signin()
{
 
    var uid = document.getElementById("usrname").value;
    var password = document.getElementById("pwd").value;
   
 
   // userdb.post({"_id": uid});
 
getdata(function(){
     var chk=0;
//Show elements
      var a,b;

      userdbase.allDocs({include_docs: true}, function(err, response) {
      if (err) {
      callback(err);
      return;
                }
      console.log(response.rows);
      var x="";
      for( var i=0;i<response.rows.length;i++){
        a = response.rows[i].doc._id;b= response.rows[i].doc.pwd; 
        
	if(uid==a && password==b)
        {
          alert("Login Successful");
          window.location='./main.html';
        }     
      } 
      }); 
     document.getElementById("changeit").innerHTML ="Login unsuccessful! Please retry or sign up" ; 

});
}
      
</script>





<script>
function mytimingfunc()
{
  

   var newdb = new PouchDB('newdb1'),
    remote = 'https://phonegap.couchappy.com/workingdatabase',
    opts = {
        continuous: true
    };

newdb.post({
    "location": 'CapeTown',
    "userid": nom 
});


newdb.replicate.to(remote, opts); 
 
}

</script>

  <script>
  
 var lat,long,date;
   
function getLocation() {
  alert("getLocation");
  
  var locOptions = {
  timeout : 10000,
  enableHighAccuracy : true
  };
  //get the current location
  navigator.geolocation.getCurrentPosition(onGeolocationSuccess, onGeolocationError,
  locOptions);
  
  //Clear the current location while we wait for a
  //reading
  document.getElementById("locationInfo").innerHTML = "Reading location...";
   
 
}
function onGeolocationSuccess(loc) {
  alert("onLocationSuccess");
  //We received something from the API, so first get the
  // timestamp in a date object so we can work with it
  var d = new Date(loc.timestamp);
  //Then replace the page's content with the current
  // location retrieved from the API
 document.getElementById("locationInfo").innerHTML= '<b>Current Location</b><hr />' +  '<b>Latitude</b>: ' + loc.coords.latitude +  '<br /><b>Longitude</b>: ' + loc.coords.longitude +
  '<br /><b>Altitude</b>: ' + loc.coords.altitude +
  '<br /><b>Accuracy</b>: ' + loc.coords.accuracy +
  '<br /><b>Altitude Accuracy</b>: ' +
  loc.coords.altitudeAccuracy +
  '<br /><b>Heading</b>: ' + loc.coords.heading +
  '<br /><b>Speed</b>: ' + loc.coords.speed +
  '<br /><b>Timestamp</b>: ' + d.toLocaleString() ;
  date = d.toString();
  alert(date);
  lat = loc.coords.latitude;
  long = loc.coords.longitude;
   
}

function onGeolocationError(e) {
  alert("Geolocation error: #" + e.code + "\n" +
  e.message); 
}
</script>
  

<script>
function signup()
{
  window.location='./signup.html';
}

</script>

<script>
function changeperson()
{
  monitoring=prompt("Please enter the name of the person you want to monitor!","");
  document.getElementById("changethis").innerHTML=monitoring;
document.getElementById("monitorwho").innerHTML="Where is "+monitoring+"?";


}
</script>


<script>
function displayresult()
{
   var dispdbase = new PouchDB('dispdbase2'),
    remote = 'https://phonegap.couchappy.com/workingdatabase',
    opts = {
        continuous: true
    };
dispdbase.replicate.from(remote, opts); 
  alert("Done replicatin anotha");

//Show elements
   var a,b;

 dispdbase.allDocs({include_docs: true}, function(err, response) {
      if (err) {
      callback(err);
      return;
                }
      console.log(response.rows);
      var x =""+monitoring+" was at:\n";
      for( var i=0;i<response.rows.length;i++){
        a = response.rows[i].doc.userid;b= response.rows[i].doc.location; 
        if(a==monitoring){x =""+x+""+b + " " +"\n\n" ;}
       
      }
       alert(x);
                 });
 

  
 
}
</script>



  <script>
  function dispmap(){
  /** uses leaflet http://leafletjs.com/examples/mobile.html **/
var map = L.map('map', {
  inertia: true,
  inertiaDeceleration: 2000
});
// http://{s}.tile.osm.org/{z}/{x}/{y}.png
// http://{s}.tile.cloudmade.com/BC9A493B41014CAABB98F0471D759707/997/256/{z}/{x}/{y}.png
L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
    attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="http://cloudmade.com">CloudMade</a>',
    maxZoom: 18
}).addTo(map);

map.locate({setView: true, maxZoom: 15});

function onLocationFound(e) {
    var radius = e.accuracy/2;

    L.marker(e.latlng).addTo(map)
        .bindPopup("You are within " + radius + " meters from this point").openPopup();

    L.circle(e.latlng, radius).addTo(map);
    map.initlat = e.latlng.lat;
    map.initlng = e.latlng.lng;
}

map.on('locationfound', onLocationFound);

function onLocationError(e) {
    alert(e.message);
}

map.on('locationerror', onLocationError);
map.on('move', function(){
  var zm = map.getZoom();
  var ctr = map.getCenter(); 
  var ll = 'ZOOM:' + zm + ' | MAPCENTER: Lat: '+ ctr['lat'].toFixed(4) + ' Lng: '+ ctr['lng'].toFixed(4) + ' | <span id="recenter">Re-center</span>';
   $('#data').html(ll); 
});

$('#data').on('click', '#recenter',function(){
  map.panTo({lon: map.initlng, lat: map.initlat}, {'animate': true});                  
});

	

  }
 
</script>


<script>


	var userdbase = new PouchDB('theuserlist'),
    	remote = 'https://phonegap.couchappy.com/loginlist',
    	opts = {
        	continuous: true
    	};
	

function getdata(callbackFunction)
{
   userdbase.replicate.from(remote, opts);
   callbackFunction(); 
} 
  </script>
<script>
function getfunc()
{
userdbase.replicate.from(remote, opts);
}
</script>
</head>
<body onLoad="getfunc()">
  <div data-role="page">

    <div data-role="panel" id="panel" data-position="right" data-theme="a" data-display="push"></div>

    <div data-role="header">
      <a data-iconpos="notext" data-role="button" data-icon="home" title="Home">Home</a>
      <h1>GPS Tracker User Login</h1>
      <a data-iconpos="notext" href="#panel" data-role="button" data-icon="flat-menu"></a>
    </div>

    <div data-role="content" role="main">
     <!-- <p>Sample text and <a href="#">links</a>.</p>
      <fieldset class="ui-grid-a">
        <div class="ui-block-a"><button data-icon="flat-settings" data-theme="a">Button A</button></div>
        <div class="ui-block-b"><button data-icon="flat-new" data-theme="b">Button B</button></div>
      </fieldset>
      <fieldset class="ui-grid-a">
        <div class="ui-block-a"><button data-icon="flat-man" data-theme="c">Button C</button></div>
        <div class="ui-block-b"><button data-icon="flat-mail" data-theme="d">Button D</button></div>
      </fieldset> -->
      <fieldset class="ui-grid-a">
        <b><p id="changeit">Login</p></b>
	Username<input type="text" id="usrname">
 	Password<input type="password" id="pwd">
        <div data-theme="b" data-content-theme="b" ><button onclick="signin()" data-icon="flat-location" data-theme="e">Sign In</button></div>
        <div data-theme="b" data-content-theme="b"><button data-icon="flat-calendar" data-theme="f" onclick="signup()">Click here to Sign Up</button></div>
      <div id="locationInfo"></div>
      </fieldset>

    <!--  <ul data-role="listview" data-inset="true">
        <li data-role="list-divider" data-theme="a">List Header</li>
        <li>Read-only list item</li>
        <li><a href="#">Linked list item</a></li>
      </ul> -->

    <!--  <div data-role="collapsible-set" data-theme="b" data-content-theme="b">
        <div data-role="collapsible" data-collapsed-icon="flat-time" data-expanded-icon="flat-cross" data-collapsed="false">
          <h3>Recent Locations</h3>
          <p div = "recent locations">I'm the collapsible content for section 1</p>
        </div>
        <div data-role="collapsible" data-collapsed-icon="flat-calendar" data-expanded-icon="flat-cross">
          <h3>Section 2</h3>
          <p>I'm the collapsible content for section 2</p>
        </div>
        <div data-role="collapsible" data-collapsed-icon="flat-settings" data-expanded-icon="flat-cross">
          <h3>Section 3</h3>
          <p>I'm the collapsible content for section 3</p>
        </div> 
      </div>

      <div data-role="fieldcontain">
        <fieldset data-role="controlgroup">
          <input type="radio" name="radio-choice-a" data-theme="c" id="radio-choice-1-a" value="choice-1" checked="checked" />
          <label for="radio-choice-1-a">Radio 1</label>

          <input type="radio" name="radio-choice-a" data-theme="c" id="radio-choice-1-b" value="choice-2"  />
          <label for="radio-choice-1-b">Radio 2</label>
          <input type="checkbox" name="checkbox-a" data-theme="c" id="checkbox-a" checked="checked" />
          <label for="checkbox-a">Checkbox</label>
        </fieldset>
      </div>

  <!--    <div data-role="fieldcontain">
        <a href="#" data-role="button" data-icon="home" data-iconpos="notext" data-theme="b" data-inline="true">Home</a>
        <a href="#" data-role="button" data-icon="flat-video" data-iconpos="notext" data-theme="b" data-inline="true">Video</a>
        <a href="#" data-role="button" data-icon="flat-time" data-iconpos="notext" data-theme="b" data-inline="true">Time</a>
        <a href="#" data-role="button" data-icon="flat-settings" data-iconpos="notext" data-theme="b" data-inline="true">Settings</a>
        <a href="#" data-role="button" data-icon="flat-plus" data-iconpos="notext" data-theme="b" data-inline="true">Plus</a>
        <a href="#" data-role="button" data-icon="flat-new" data-iconpos="notext" data-theme="b" data-inline="true">New</a>
        <a href="#" data-role="button" data-icon="flat-menu" data-iconpos="notext" data-theme="b" data-inline="true">Menu</a>
        <a href="#" data-role="button" data-icon="flat-man" data-iconpos="notext" data-theme="b" data-inline="true">Man</a>
        <a href="#" data-role="button" data-icon="flat-mail" data-iconpos="notext" data-theme="b" data-inline="true">Mail</a>
        <a href="#" data-role="button" data-icon="flat-lock" data-iconpos="notext" data-theme="b" data-inline="true">Lock</a> 
        <a href="#" data-role="button" data-icon="flat-location" data-iconpos="notext" data-theme="b" data-inline="true">Location</a>
        <a href="#" data-role="button" data-icon="flat-heart" data-iconpos="notext" data-theme="b" data-inline="true">Heart</a>
        <a href="#" data-role="button" data-icon="flat-eye" data-iconpos="notext" data-theme="b" data-inline="true">Eye</a>
        <a href="#" data-role="button" data-icon="flat-cross" data-iconpos="notext" data-theme="b" data-inline="true">Cross</a>
        <a href="#" data-role="button" data-icon="flat-cmd" data-iconpos="notext" data-theme="b" data-inline="true">Cmd</a>
        <a href="#" data-role="button" data-icon="flat-checkround" data-iconpos="notext" data-theme="b" data-inline="true">Checkround</a>
        <a href="#" data-role="button" data-icon="flat-calendar" data-iconpos="notext" data-theme="b" data-inline="true">Calendar</a>
        <a href="#" data-role="button" data-icon="flat-bubble" data-iconpos="notext" data-theme="b" data-inline="true">Bubble</a>
        <a href="#" data-role="button" data-icon="flat-volume" data-iconpos="notext" data-theme="b" data-inline="true">Volume</a>
        <a href="#" data-role="button" data-icon="flat-camera" data-iconpos="notext" data-theme="b" data-inline="true">Camera</a> 
      </div>

      <select name="flip-1" id="flip-1" data-role="slider">
        <option value="off">Off</option>
        <option value="on" selected>On</option>
      </select>

        <div data-role="fieldcontain">
        <div data-role="controlgroup" data-type="horizontal">
          <a href="#" data-icon="flat-mail" data-theme="a" data-iconpos="notext" data-role="button">Yes</a>
          <a href="#" data-icon="flat-camera" data-theme="a" data-iconpos="notext" data-role="button">Yes</a>
          <a href="#" data-icon="flat-heart" data-theme="a" data-iconpos="notext" data-role="button">Yes</a>
          <a href="#" data-icon="flat-eye" data-theme="a" data-iconpos="notext" data-role="button">Yes</a>
        </div>
      </div>

        <div data-role="fieldcontain">
        <select name="select-choice" id="select-choice-a" data-native-menu="false" data-theme="a">
          <option value="standard">Option 1</option>
          <option value="rush">Option 2</option>
          <option value="express">Option 3</option>
          <option value="overnight">Option 4</option>
        </select>
      </div> -->

<!--      <input type="text" placeholder="Text Input" />
      <div data-role="fieldcontain">
        <input type="range" name="slider" value="50" min="0" max="100" data-highlight="true" />
      </div>
    </div>
  </div> -->
  
<div style="height: 180px;;" id="map"></div>
  <div id="highlight"> </div>
</body >
</html>
